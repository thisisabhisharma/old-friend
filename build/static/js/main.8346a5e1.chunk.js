(this["webpackJsonpold-friend"]=this["webpackJsonpold-friend"]||[]).push([[0],{13:function(e,t,a){"use strict";a.r(t),a.d(t,"SCHOOL_LIST_REQUEST",(function(){return n})),a.d(t,"SCHOOL_LIST_SUCCESS",(function(){return r})),a.d(t,"SCHOOL_LIST_FAIL",(function(){return l})),a.d(t,"SCHOOL_INFO_REQUEST",(function(){return o})),a.d(t,"SCHOOL_INFO_SUCCESS",(function(){return c})),a.d(t,"SCHOOL_INFO_FAIL",(function(){return s}));var n="SCHOOL_LIST_REQUEST",r="SCHOOL_LIST_SUCCESS",l="SCHOOL_LIST_FAIL",o="SCHOOL_INFO_REQUEST",c="SCHOOL_INFO_SUCCESS",s="SCHOOL_INFO_FAIL"},35:function(e,t,a){e.exports=a.p+"static/media/school_image.19145815.jpg"},37:function(e,t,a){e.exports=a(68)},42:function(e,t,a){},43:function(e,t,a){},68:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(18),o=a.n(l),c=(a(42),a(3)),s=(a(43),a(1)),i=a(6),u=a.n(i),m=a(11),d=a(12),E=a.n(d),p={BASE_LINK:"https://project.harshitaapptech.com/oldschool/server/api"},S=p.BASE_LINK,f=(a(66),a(5)),h=a(35),g=a.n(h);function v(e){var t=e.school;return r.a.createElement("div",{key:t.sid,className:"card"},r.a.createElement("img",{className:"medium",src:g.a,alt:t.school_name}),r.a.createElement("div",{className:"card-body"},r.a.createElement(f.b,{to:"/school/".concat(t.sid)},r.a.createElement("h2",null,t.school_name),r.a.createElement("p",null,t.school_address))))}function O(){return r.a.createElement("div",{className:"loading"},r.a.createElement("i",{className:"fa fa-spinner fa-spin"})," Loading...")}function I(e){return r.a.createElement("div",{className:"alert alert-".concat(e.variant||"info")},e.children)}var b=a(13),y=p.BASE_LINK;function _(e){var t=localStorage.getItem("userInfo"),a=Object(s.b)(),l=Object(s.c)((function(e){return e.schoolList})),o=Object(s.c)((function(e){return e.userSignin})).userInfo,i=l.loading,d=l.error,p=l.schools,S=Object(n.useState)(""),f=Object(c.a)(S,2),h=f[0],g=f[1];Object(n.useEffect)((function(){null==t&&e.history.push("/signin"),a(function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:b.SCHOOL_LIST_REQUEST}),e.prev=1,e.next=4,E.a.get(y+"/getallschool/");case 4:a=e.sent,n=a.data,t({type:b.SCHOOL_LIST_SUCCESS,payload:n}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t({type:b.SCHOOL_LIST_FAIL,payload:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}())}),[a,e.history,t,h]);var _=function(e){console.log(e,"onclickHandler called"),g(e),a(function(e,t){return function(){var a=Object(m.a)(u.a.mark((function a(n){var r,l,o;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n({type:b.SCHOOL_INFO_REQUEST,payload:{sid:e}}),r={headers:{Authorization:"Bearer ".concat(t.token)}},a.prev=2,a.next=5,E.a.post(y+"/getusersfromschool/",{sid:e},r);case 5:l=a.sent,o=l.data,n({type:b.SCHOOL_INFO_SUCCESS,payload:o}),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(2),n({type:b.SCHOOL_INFO_FAIL,payload:a.t0.response&&a.t0.response.data.message?a.t0.response.data.message:a.t0.message});case 13:case"end":return a.stop()}}),a,null,[[2,10]])})));return function(e){return a.apply(this,arguments)}}()}(e,o))};return r.a.createElement("div",null,r.a.createElement("h2",null,"Featured schools"),i?r.a.createElement(O,null):d?r.a.createElement(I,{variant:"danger"},d):r.a.createElement(r.a.Fragment,null,0===p.length&&r.a.createElement(I,null,"No school Found"),r.a.createElement("div",null,p.data.map((function(e){return r.a.createElement("div",{onClick:function(){return _(e.sid)},className:"row center"},r.a.createElement(v,{key:e.sid,school:e}))})))))}function N(e){var t=Object(n.useState)(""),a=Object(c.a)(t,2),l=a[0],o=a[1],i=Object(n.useState)(""),d=Object(c.a)(i,2),p=d[0],h=d[1],g=e.location.search?e.location.search.split("=")[1]:"/",v=Object(s.c)((function(e){return e.userSignin})),b=v.userInfo,y=v.loading,_=v.error,N=Object(s.b)();return Object(n.useEffect)((function(){b&&e.history.push(g)}),[e.history,g,b]),r.a.createElement("div",null,r.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),N(function(e,t){return function(){var a=Object(m.a)(u.a.mark((function a(n){var r,l;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n({type:"USER_SIGNIN_REQUEST",payload:{email:e,password:t}}),a.prev=1,a.next=4,E.a.post(S+"/users/login",{email:e,password:t});case 4:r=a.sent,l=r.data,console.log(l.message,"this is data"),n({type:"USER_SIGNIN_SUCCESS",payload:l}),localStorage.setItem("userInfo",JSON.stringify(l)),a.next=15;break;case 11:a.prev=11,a.t0=a.catch(1),console.log(a.t0,"this is error"),n({type:"USER_SIGNIN_FAIL",payload:a.t0.response&&a.t0.response.data.message?a.t0.response.data.message:a.t0.message});case 15:case"end":return a.stop()}}),a,null,[[1,11]])})));return function(e){return a.apply(this,arguments)}}()}(l,p))}},r.a.createElement("div",null,r.a.createElement("h1",null,"User Sign In")),y&&r.a.createElement(O,null),_&&r.a.createElement(I,{variant:"danger"},_),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"email"},"Email address"),r.a.createElement("input",{type:"email",id:"email",placeholder:"Enter email",required:!0,onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",id:"password",placeholder:"Enter password",required:!0,onChange:function(e){return h(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null),r.a.createElement("button",{className:"primary",type:"submit"},"Sign In")),r.a.createElement("div",null,r.a.createElement("label",null),r.a.createElement("div",null,"New user?"," ",r.a.createElement(f.b,{to:"/register?redirect=".concat(g)},"Create your account")))))}function C(e){var t=Object(n.useState)(""),a=Object(c.a)(t,2),l=a[0],o=a[1],i=Object(n.useState)(""),d=Object(c.a)(i,2),p=d[0],h=d[1],g=Object(n.useState)(""),v=Object(c.a)(g,2),b=v[0],y=v[1],_=Object(n.useState)(""),N=Object(c.a)(_,2),C=N[0],L=N[1],w=e.location.search?e.location.search.split("=")[1]:"/",j=Object(s.c)((function(e){return e.userRegister})),U=j.userInfo,F=j.loading,R=j.error,A=Object(s.b)();return Object(n.useEffect)((function(){U&&e.history.push(w)}),[e.history,w,U]),r.a.createElement("div",null,r.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),b!==C?alert("Password and confirm password are not match"):A(function(e,t,a){return function(){var n=Object(m.a)(u.a.mark((function n(r){var l,o;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:"USER_REGISTER_REQUEST",payload:{email:t,password:a}}),n.prev=1,n.next=4,E.a.post(S+"/users/register",{name:e,email:t,password:a});case 4:l=n.sent,o=l.data,r({type:"USER_REGISTER_SUCCESS",payload:o}),r({type:"USER_SIGNIN_SUCCESS",payload:o}),localStorage.setItem("userInfo",JSON.stringify(o)),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(1),r({type:"USER_REGISTER_FAIL",payload:n.t0.response&&n.t0.response.data.message?n.t0.response.data.message:n.t0.message});case 14:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(e){return n.apply(this,arguments)}}()}(l,p,b))}},r.a.createElement("div",null,r.a.createElement("h1",null,"Create Account")),F&&r.a.createElement(O,null),R&&r.a.createElement(I,{variant:"danger"},R),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"name"},"Name"),r.a.createElement("input",{type:"text",id:"name",placeholder:"Enter name",required:!0,onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"email"},"Email address"),r.a.createElement("input",{type:"email",id:"email",placeholder:"Enter email",required:!0,onChange:function(e){return h(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",id:"password",placeholder:"Enter password",required:!0,onChange:function(e){return y(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm Password"),r.a.createElement("input",{type:"password",id:"confirmPassword",placeholder:"Enter confirm password",required:!0,onChange:function(e){return L(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null),r.a.createElement("button",{className:"primary",type:"submit"},"Register")),r.a.createElement("div",null,r.a.createElement("label",null),r.a.createElement("div",null,"Already have an account?"," ",r.a.createElement(f.b,{to:"/signin?redirect=".concat(w)},"Sign-In")))))}var L=a(2);function w(e){var t=Object(n.useState)(""),a=Object(c.a)(t,2),l=a[0],o=a[1],i=Object(n.useState)(""),d=Object(c.a)(i,2),p=d[0],f=d[1],h=e.location.search?e.location.search.split("=")[1]:"/",g=Object(s.c)((function(e){return e.adminSignin})),v=g.adminInfo,b=g.loading,y=g.error,_=Object(s.b)();return Object(n.useEffect)((function(){v&&e.history.push("/adminpanel")}),[e.history,h,v]),r.a.createElement("div",null,r.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),_(function(e,t){return function(){var a=Object(m.a)(u.a.mark((function a(n){var r,l;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n({type:"ADMIN_SIGNIN_REQUEST",payload:{email:e,password:t}}),a.prev=1,a.next=4,E.a.post(S+"/users/login",{email:e,password:t});case 4:r=a.sent,1===(l=r.data).isAdmin?(n({type:"ADMIN_SIGNIN_SUCCESS",payload:l}),localStorage.setItem("adminInfo",JSON.stringify(l.token))):0===l.isAdmin&&(n({type:"ADMIN_SIGNIN_FAIL"}),alert("you are not admin. Dont even try :p")),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(1),n({type:"ADMIN_SIGNIN_FAIL",payload:a.t0.response&&a.t0.response.data.message?a.t0.response.data.message:a.t0.message});case 12:case"end":return a.stop()}}),a,null,[[1,9]])})));return function(e){return a.apply(this,arguments)}}()}(l,p))}},r.a.createElement("div",null,r.a.createElement("h1",null,"Admin Sign In")),b&&r.a.createElement(O,null),y&&r.a.createElement(I,{variant:"danger"},y),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"email"},"Email address"),r.a.createElement("input",{type:"email",id:"email",placeholder:"Enter email",required:!0,onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",id:"password",placeholder:"Enter password",required:!0,onChange:function(e){return f(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null),r.a.createElement("button",{className:"primary",type:"submit"},"Sign In as Admin"))))}function j(e){var t=Object(n.useState)(""),a=Object(c.a)(t,2),l=a[0],o=a[1],i=Object(n.useState)(""),d=Object(c.a)(i,2),p=d[0],f=d[1],h=Object(n.useState)(""),g=Object(c.a)(h,2),v=g[0],b=g[1],y=Object(n.useState)(""),_=Object(c.a)(y,2),N=_[0],C=_[1],L=Object(n.useState)(""),w=Object(c.a)(L,2),j=w[0],U=w[1],F=Object(s.c)((function(e){return e.adminSignin})),R=F.adminInfo,A=F.loading,T=F.error,k=Object(s.b)();return r.a.createElement("div",null,r.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),k(function(e,t,a,n,r,l){return function(){var o=Object(m.a)(u.a.mark((function o(c){var s,i,m;return u.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c({type:"ADD_SCHOOL_REQUEST",payload:{schoolName:e,schoolAddress:t,schoolLat:a,schoolLong:n,createdBy:r}}),s={headers:{Authorization:"Bearer ".concat(l.token)}},o.prev=2,console.log(l.token,"this is admin token"),o.next=6,E.a.post(S+"/addschool/",{schoolName:e,schoolAddress:t,schoolLat:a,schoolLong:n,createdBy:r},s);case 6:i=o.sent,m=i.data,console.log(m.message,"this is data"),c({type:"ADD_SCHOOL_SUCCESS",payload:m}),alert("school added successfully"),o.next=17;break;case 13:o.prev=13,o.t0=o.catch(2),console.log(o.t0,"this is error"),c({type:"ADD_SCHOOL_FAIL",payload:o.t0.response&&o.t0.response.data.message?o.t0.response.data.message:o.t0.message});case 17:case"end":return o.stop()}}),o,null,[[2,13]])})));return function(e){return o.apply(this,arguments)}}()}(l,p,v,N,j,R))}},r.a.createElement("div",null,r.a.createElement("h2",null,"Admin Panel"),r.a.createElement("h2",null,"Add school")),A&&r.a.createElement(O,null),T&&r.a.createElement(I,{variant:"danger"},T),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"name"},"School Name"),r.a.createElement("input",{type:"text",id:"name",placeholder:"Enter name",required:!0,onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"address"},"address"),r.a.createElement("input",{type:"text",id:"address",placeholder:"Enter School Address",required:!0,onChange:function(e){return f(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"lat"},"lat"),r.a.createElement("input",{type:"text",id:"lat",placeholder:"Enter School lat",required:!0,onChange:function(e){return b(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"long"},"long"),r.a.createElement("input",{type:"text",id:"long",placeholder:"Enter School long",required:!0,onChange:function(e){return C(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"created by"},"created by"),r.a.createElement("input",{type:"text",id:"creator",placeholder:"Created by",required:!0,onChange:function(e){return U(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",null),r.a.createElement("button",{className:"primary",type:"submit"},"Submit"))))}function U(e){var t=e.student;return r.a.createElement("div",{key:t.sid,className:"card"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h2",null,t.name),r.a.createElement("p",null,t.year),r.a.createElement("p",null,t.special_note)))}function F(){var e=Object(s.c)((function(e){return e.school})),t=e.loading,a=e.error,n=e.schoolInfo;return r.a.createElement("div",null,t?r.a.createElement(O,null):a?r.a.createElement(I,{variant:"danger"},a):r.a.createElement("div",null,r.a.createElement(f.b,{to:"/"},"Back to result"),r.a.createElement("h2",null,"Featured people"),r.a.createElement(r.a.Fragment,null,0===n.length&&r.a.createElement(I,null,"No school Found"),r.a.createElement("div",{className:"row center"},n.data.uid.map((function(e){return r.a.createElement(U,{key:e.sid,student:e})}))))))}var R=function(){var e=Object(s.c)((function(e){return e.userSignin})),t=Object(s.c)((function(e){return e.adminSignin})),a=Object(n.useState)(!1),l=Object(c.a)(a,2),o=l[0],i=l[1],u=e.userInfo,m=t.adminInfo,d=Object(s.b)();return r.a.createElement(f.a,null,r.a.createElement("div",{className:"grid-container"},r.a.createElement("header",{className:"row"},r.a.createElement("div",null,r.a.createElement("button",{type:"button",className:"open-sidebar",onClick:function(){return i(!0)}},r.a.createElement("i",{className:"fa fa-bars"})),r.a.createElement(f.b,{className:"brand",to:"/"},"OLD FRIEND")),r.a.createElement("div",null,m?r.a.createElement("div",{className:"dropdown"},r.a.createElement(f.b,{to:"#"},m.name," ",r.a.createElement("i",{className:"fa fa-caret-down"})," "),r.a.createElement("ul",{className:"dropdown-content"},r.a.createElement("li",null,r.a.createElement(f.b,{to:"#admin",onClick:function(){d((function(e){localStorage.removeItem("adminInfo"),e({type:"ADMIN_SIGNOUT"}),document.location.href="/admin"}))}},"Sign Out as admin")))):r.a.createElement(f.b,{to:"/admin"},"Sign In as admin"),u?r.a.createElement("div",{className:"dropdown"},r.a.createElement(f.b,{to:"#"},u.name," ",r.a.createElement("i",{className:"fa fa-caret-down"})," "),r.a.createElement("ul",{className:"dropdown-content"},r.a.createElement("li",null,r.a.createElement(f.b,{to:"#signout",onClick:function(){d((function(e){localStorage.removeItem("userInfo"),e({type:"USER_SIGNOUT"}),document.location.href="/signin"}))}},"Sign Out")))):r.a.createElement(f.b,{to:"/signin"},"User Sign In"))),r.a.createElement("aside",{className:o?"open":""},r.a.createElement("ul",{className:"categories"},r.a.createElement("li",null,r.a.createElement("strong",null,"User Info"),r.a.createElement("button",{onClick:function(){return i(!1)},className:"close-sidebar",type:"button"},r.a.createElement("i",{className:"fa fa-close"}))))),r.a.createElement("main",null,r.a.createElement(L.a,{path:"/signin",exact:!0,component:N}),r.a.createElement(L.a,{exact:!0,path:"/",component:_}),r.a.createElement(L.a,{path:"/school/:id",component:F}),r.a.createElement(L.a,{path:"/register",component:C}),r.a.createElement(L.a,{path:"/admin",component:w,exact:!0}),r.a.createElement(L.a,{path:"/adminpanel",component:j,exact:!0})),r.a.createElement("footer",{className:"row center"},"All right reserved")))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var A=a(14),T=a(36),k=a(13),x=k.SCHOOL_LIST_REQUEST,H=k.SCHOOL_LIST_SUCCESS,D=k.SCHOOL_LIST_FAIL,G=k.SCHOOL_INFO_FAIL,Q=k.SCHOOL_INFO_REQUEST,q=k.SCHOOL_INFO_SUCCESS,M={userSignin:{userInfo:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")):null},adminSignin:{adminInfo:localStorage.getItem("adminInfo")?JSON.parse(localStorage.getItem("adminInfo")):null}},B=Object(A.c)({userSignin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_SIGNIN_REQUEST":return{loading:!0};case"USER_SIGNIN_SUCCESS":return{loading:!1,userInfo:t.payload};case"USER_SIGNIN_FAIL":return{loading:!1,error:t.payload};case"USER_SIGNOUT":return{};default:return e}},userRegister:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_REGISTER_REQUEST":return{loading:!0};case"USER_REGISTER_SUCCESS":return{loading:!1,userInfo:t.payload};case"USER_REGISTER_FAIL":return{loading:!1,error:t.payload};default:return e}},schoolList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!0,schools:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return{loading:!0};case H:return{loading:!1,schools:t.payload};case D:return{loading:!1,error:t.payload};default:return e}},adminSignin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADMIN_SIGNIN_REQUEST":return{loading:!0};case"ADMIN_SIGNIN_SUCCESS":return{loading:!1,adminInfo:t.payload};case"ADMIN_SIGNIN_FAIL":return{loading:!1,error:t.payload};case"ADMIN_SIGNOUT":return{};default:return e}},school:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!0,schoolInfo:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:return{loading:!0};case q:return{loading:!1,schoolInfo:t.payload};case G:return{loading:!1,error:t.payload};default:return e}}}),P=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||A.d,J=Object(A.e)(B,M,P(Object(A.a)(T.a)));o.a.render(r.a.createElement(s.a,{store:J},r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.8346a5e1.chunk.js.map